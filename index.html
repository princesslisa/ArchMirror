<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Architect's Mirror</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- PDF Generation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --bg-dark: #121212;
            --forest-green: #0a1f1a;
            --forest-light: #15332b;
            --gold: #D4AF37;
            --gold-dim: #8a701e;
            --cream: #f5f5f0;
            --text-grey: #a0a0a0;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 20px 0 100px 0;
            background: radial-gradient(circle at center, #bfbfbf 0%, #636363 100%);
            font-family: 'Montserrat', sans-serif;
            color: var(--cream);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- THE DOCUMENT CONTAINER --- */
        #mirror-doc {
            width: 100%;
            max-width: 600px;
            background-color: var(--forest-green);
            background-image: linear-gradient(rgba(10, 31, 26, 0.95), rgba(10, 31, 26, 0.95)), 
                            url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23D4AF37' fill-opacity='0.05'%3E%3Cpath d='M0 0h20L0 20z'/%3E%3C/g%3E%3C/svg%3E");
            padding: 40px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
            border: 1px solid #333;
            position: relative;
        }

        /* Gold Top Bar */
        #mirror-doc::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--gold-dim), var(--gold), var(--gold-dim));
        }

        /* --- HEADER --- */
        .header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 1px solid rgba(212, 175, 55, 0.3);
            padding-bottom: 20px;
        }

        .brand {
            color: var(--gold);
            font-size: 10px;
            letter-spacing: 4px;
            text-transform: uppercase;
            font-weight: 700;
            display: block;
            margin-bottom: 10px;
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 28px;
            margin: 0;
            color: var(--cream);
            text-transform: uppercase;
            line-height: 1.2;
        }

        .sub-head {
            font-size: 12px;
            color: var(--text-grey);
            margin-top: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* --- PERSONAL INFO --- */
        .meta-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .meta-field label {
            display: block;
            font-size: 10px;
            color: var(--gold);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .meta-field input {
            width: 100%;
            background: rgba(0,0,0,0.2);
            border: none;
            border-bottom: 1px solid var(--gold-dim);
            color: white;
            padding: 8px;
            font-family: 'Montserrat', sans-serif;
        }

        /* --- QUOTE BOX --- */
        .quote-box {
            background: rgba(212, 175, 55, 0.05);
            border-left: 3px solid var(--gold);
            padding: 15px;
            font-size: 12px;
            font-style: italic;
            color: #ccc;
            margin-bottom: 40px;
            line-height: 1.5;
        }

        /* --- SECTIONS --- */
        .section-title {
            font-family: 'Cinzel', serif;
            color: var(--gold);
            font-size: 16px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 5px;
            margin-bottom: 20px;
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            /* Avoid splitting the title itself */
            page-break-inside: avoid;
            page-break-after: avoid; 
        }

        .section-number {
            font-size: 30px;
            opacity: 0.2;
            font-weight: 700;
            line-height: 0.8;
        }

        /* --- FORM QUESTIONS --- */
        .question-block {
            margin-bottom: 25px;
            /* Allow breaking BETWEEN questions, but try to keep a question together */
            page-break-inside: avoid; 
        }

        .q-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
            color: #eee;
        }

        .q-sub {
            display: block;
            font-size: 11px;
            color: #888;
            margin-bottom: 12px;
            font-style: italic;
        }
        
        /* Indented sub-questions for the Diagnostic Audit */
        .q-nested {
            margin-left: 15px;
            margin-bottom: 20px;
            border-left: 1px solid rgba(212, 175, 55, 0.3);
            padding-left: 15px;
            /* CRITICAL FIX: Allow page break INSIDE the large audit block, 
               but keep each individual nested question together */
            page-break-inside: avoid; 
        }

        /* Text Areas */
        textarea {
            width: 100%;
            background: rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
            border-left: 2px solid var(--gold-dim);
            color: white;
            padding: 12px;
            font-family: 'Montserrat', sans-serif;
            font-size: 13px;
            line-height: 1.5;
            min-height: 60px;
            resize: vertical;
        }

        textarea:focus {
            outline: none;
            border-color: var(--gold);
            background: rgba(0,0,0,0.3);
        }

        /* Selection Buttons (Radio replacement) */
        .options-grid {
            display: grid;
            gap: 10px;
        }

        .option-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 12px 15px;
            font-size: 12px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }

        .option-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        .option-btn.selected {
            background: var(--gold);
            color: #000;
            border-color: var(--gold);
            font-weight: 600;
        }

        .option-check {
            width: 16px;
            height: 16px;
            border: 1px solid #666;
            margin-right: 12px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .option-btn.selected .option-check {
            border-color: #000;
            background: #000;
        }

        .option-btn.selected .option-check::after {
            content: '';
            width: 6px;
            height: 6px;
            background: var(--gold);
            border-radius: 50%;
        }

        /* --- FOOTER --- */
        .doc-footer {
            margin-top: 60px;
            text-align: center;
            border-top: 1px solid rgba(212, 175, 55, 0.3);
            padding-top: 30px;
            page-break-inside: avoid;
        }

        .pledge {
            font-family: 'Cinzel', serif;
            font-size: 14px;
            color: var(--gold);
            margin-bottom: 30px;
        }

        .signature-box {
            width: 80%;
            margin: 0 auto;
            border-bottom: 1px solid var(--gold);
        }
        
        .signature-box input {
            width: 100%;
            background: transparent;
            border: none;
            color: white;
            text-align: center;
            font-family: 'Scripts', cursive, 'Montserrat'; /* Fallback */
            font-style: italic;
            font-size: 18px;
            padding: 10px;
        }

        /* --- FIXED CONTROLS --- */
        .controls {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.95);
            padding: 20px;
            display: flex;
            justify-content: center;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
            z-index: 999;
        }

        button.export-btn {
            background: linear-gradient(135deg, var(--gold), var(--gold-dim));
            color: #0a1f1a;
            border: none;
            padding: 16px 40px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            max-width: 400px;
        }

        /* Mobile tweaks */
        @media (max-width: 600px) {
            #mirror-doc {
                padding: 25px;
            }
            .section-number {
                font-size: 24px;
            }
        }
        
        /* --- PDF EXPORT OVERRIDES --- */
        /* These classes are applied via JS during export only */
        
        body.exporting {
            /* Force white bg so margins don't look weird */
            background: #ffffff !important;
            align-items: flex-start !important; /* Forces Left Alignment */
            width: 794px !important; /* Exact A4 width in pixels at 96dpi */
            overflow: visible !important;
        }

        .exporting #mirror-doc {
            max-width: none !important;
            width: 100% !important;
            margin: 0 !important;
            box-shadow: none !important;
            border: none !important;
            /* Ensure text contrast is high for PDF */
            background-color: #0a1f1a !important; 
        }

        .exporting .controls {
            display: none !important;
        }

    </style>
</head>
<body>

    <!-- THE DOCUMENT TO EXPORT -->
    <div id="mirror-doc">
        
        <div class="header">
            <span class="brand">Peak Within</span>
            <h1>The Architect's Mirror</h1>
            <div class="sub-head">Operational Audit | Session 0</div>
        </div>

        <div class="meta-grid">
            <div class="meta-field">
                <label>Name</label>
                <input type="text" placeholder="Your Name">
            </div>
            <div class="meta-field">
                <label>Date</label>
                <input type="text" placeholder="Jan 2026">
            </div>
        </div>

        <div class="quote-box">
            "You cannot build a skyscraper on a foundation you haven't inspected. This is not a personality test. This is a site survey. Be honest. Be clinical."
        </div>

        <!-- SECTION 1 -->
        <div class="section-title">
            <span>PHYSIOLOGICAL AUDIT</span>
            <span class="section-number">01</span>
        </div>

        <div class="question-block">
            <span class="q-label">1. The True Rhythm</span>
            <span class="q-sub">When does your brain actually switch on?</span>
            <div class="options-grid" id="q1-options">
                <div class="option-btn" onclick="selectOption('q1', this)">
                    <div class="option-check"></div>
                    Early Bird (Focus before 9 AM)
                </div>
                <div class="option-btn" onclick="selectOption('q1', this)">
                    <div class="option-check"></div>
                    Mid-Day Peak (10 AM - 2 PM)
                </div>
                <div class="option-btn" onclick="selectOption('q1', this)">
                    <div class="option-check"></div>
                    Night Owl (Energy after sunset)
                </div>
            </div>
            
            <div class="q-nested" style="margin-top: 15px;">
                <span class="q-label" style="font-size: 12px; color: var(--gold);">Evidence Log</span>
                <span class="q-sub">Describe a day you felt fully energized without forcing it. What time was it?</span>
                <textarea placeholder="I felt best when..."></textarea>
            </div>
        </div>

        <div class="question-block">
            <span class="q-label">2. The Fuel Check</span>
            <span class="q-sub">Observe your energy levels. Do heavy meals slow you down or ground you? Does sugar give you a boost or a crash?</span>
            <textarea placeholder="Observation: After eating a heavy meal I feel... After sugar I feel..."></textarea>
        </div>

        <div class="question-block">
            <span class="q-label">3. The Crash Protocol</span>
            <span class="q-sub">What is the specific 'Warning Light' that flashes before you burn out? (e.g., Silence, Binge-Eating, Anxiety)</span>
            <textarea placeholder="My warning sign is..."></textarea>
        </div>

        <!-- SECTION 2 -->
        <div class="section-title">
            <span>COGNITIVE STYLE</span>
            <span class="section-number">02</span>
        </div>

        <div class="question-block">
            <span class="q-label">4. Input Method</span>
            <span class="q-sub">How do you master a new skill?</span>
            <div class="options-grid" id="q2-options">
                <div class="option-btn" onclick="selectOption('q2', this)">
                    <div class="option-check"></div>
                    Visual (I need diagrams/maps)
                </div>
                <div class="option-btn" onclick="selectOption('q2', this)">
                    <div class="option-check"></div>
                    Auditory (I need to discuss/listen)
                </div>
                <div class="option-btn" onclick="selectOption('q2', this)">
                    <div class="option-check"></div>
                    Kinesthetic (I need to do it with my hands)
                </div>
            </div>
        </div>

        <div class="question-block">
            <span class="q-label">5. The Lens</span>
            <span class="q-sub">Microscope (Details) vs. Telescope (Big Picture)</span>
            <textarea placeholder="I naturally lean towards..."></textarea>
        </div>

        <!-- SECTION 3 -->
        <div class="section-title">
            <span>THE REALITY CHECK</span>
            <span class="section-number">03</span>
        </div>

        <div class="question-block">
            <span class="q-label">6. Diagnostic Audit</span>
            <span class="q-sub">Distinguish between 'cool terms' and actual traits. Dig deeper into your friction points.</span>
            
            <div class="q-nested">
                <span class="q-label" style="font-size: 12px; color: var(--gold);">OCD vs. Tidy</span>
                <span class="q-sub">Do you have obsessive, intrusive thoughts (OCD) or do you just prefer order?</span>
                <textarea placeholder="Honest assessment..." style="min-height: 40px;"></textarea>
            </div>

            <div class="q-nested">
                <span class="q-label" style="font-size: 12px; color: var(--gold);">Introvert vs. Social Anxiety</span>
                <span class="q-sub">Are you drained by people (Introvert) or are you afraid of judgment (Social Anxiety)?</span>
                <textarea placeholder="Honest assessment..." style="min-height: 40px;"></textarea>
            </div>

            <div class="q-nested">
                <span class="q-label" style="font-size: 12px; color: var(--gold);">Research vs. Stalling</span>
                <span class="q-sub">Do you need more information, or are you hiding behind 'research' to avoid starting?</span>
                <textarea placeholder="I often delay because..." style="min-height: 40px;"></textarea>
            </div>

            <div class="q-nested">
                <span class="q-label" style="font-size: 12px; color: var(--gold);">High Standards vs. Fear</span>
                <span class="q-sub">Do you demand excellence, or do you refuse to ship until it's perfect because you fear criticism?</span>
                <textarea placeholder="My perfectionism is rooted in..." style="min-height: 40px;"></textarea>
            </div>
            
            <div class="q-nested">
                <span class="q-label" style="font-size: 12px; color: var(--gold);">Busy vs. Avoidance</span>
                <span class="q-sub">Are you actually productive, or are you creating chaos to avoid silence?</span>
                <textarea placeholder="I tend to get busy when..." style="min-height: 40px;"></textarea>
            </div>

             <div class="q-nested">
                <span class="q-label" style="font-size: 12px; color: var(--gold);">Stubbornness vs. Grit</span>
                <span class="q-sub">Are you persistent in your vision (Grit), or just unwilling to change a bad strategy (Stubborn)?</span>
                <textarea placeholder="Honest assessment..." style="min-height: 40px;"></textarea>
            </div>
        </div>

        <div class="question-block">
            <span class="q-label">7. Attention Span</span>
            <span class="q-sub">How long can you focus on a hard task without phone checking?</span>
            <div class="options-grid" id="q3-options">
                <div class="option-btn" onclick="selectOption('q3', this)">
                    <div class="option-check"></div>
                    Less than 15 Minutes
                </div>
                <div class="option-btn" onclick="selectOption('q3', this)">
                    <div class="option-check"></div>
                    Approx 30 Minutes
                </div>
                <div class="option-btn" onclick="selectOption('q3', this)">
                    <div class="option-check"></div>
                    60+ Minutes
                </div>
            </div>
        </div>

        <!-- SECTION 4 -->
        <div class="section-title">
            <span>THE ANCHORS</span>
            <span class="section-number">04</span>
        </div>

        <div class="question-block">
            <span class="q-label">8. The Automatic Soother</span>
            <span class="q-sub">When stressed or bored, what is the FIRST thing you reach for unconsciously?</span>
            <textarea placeholder="My anchor is..."></textarea>
        </div>

        <!-- FOOTER -->
        <div class="doc-footer">
            <div class="pledge">"I acknowledge these traits. I will build based on this truth."</div>
            <div class="signature-box">
                <input type="text" placeholder="Sign Here">
            </div>
            <div style="font-size: 10px; color: #666; margin-top: 10px; text-transform: uppercase;">The Annual Architect 2026</div>
        </div>

    </div>

    <!-- CONTROL BAR -->
    <div class="controls">
        <button class="export-btn" onclick="exportToPDF()">Export to PDF</button>
    </div>

    <script>
        function selectOption(groupId, element) {
            const container = document.getElementById(groupId + '-options');
            const buttons = container.getElementsByClassName('option-btn');
            for (let btn of buttons) { btn.classList.remove('selected'); }
            element.classList.add('selected');
        }

        function exportToPDF() {
            const element = document.getElementById('mirror-doc');
            const btn = document.querySelector('.export-btn');
            
            btn.textContent = "Generating PDF...";
            
            // 1. Activate Export Mode (Forces correct width & alignment)
            document.body.classList.add('exporting');
            
            // 2. Wait 800ms for CSS layout to snap into place
            setTimeout(() => {
                const opt = {
                    margin:       [10, 0, 10, 0], // Top/Bottom margins only
                    filename:     'My_Architect_Mirror.pdf',
                    image:        { type: 'jpeg', quality: 0.98 },
                    html2canvas:  { 
                        scale: 2, // High Res
                        useCORS: true, 
                        logging: false,
                        scrollY: 0,
                        windowWidth: 794 // Match the CSS width exactly
                    },
                    jsPDF:        { unit: 'px', format: 'a4', orientation: 'portrait' }, // Pixel-perfect A4
                    pagebreak:    { mode: ['css', 'legacy'] } 
                };

                html2pdf().set(opt).from(element).save().then(() => {
                    // 3. Reset after save
                    btn.textContent = "Export to PDF";
                    document.body.classList.remove('exporting');
                });
            }, 800);
        }
    </script>

</body>
</html>
